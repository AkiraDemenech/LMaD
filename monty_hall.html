<!DOCTYPE html>
<html lang='pt-BR'>
	<head>
		<meta charset='UTF-8'>
		<title>
			Problema de Monty Hall
		</title>
	</head>

	<body>
		<h1>
			Vamos fazer as portas do problema de Monty Hall
		</h1>

<center id='portas'></center>

<script>
	const MANTER_PORTA = 'portas/manter.png'
	const TROCAR_PORTA = 'portas/trocar.png'
	const PORTA_FECHADA = 'portas/fechada.png'
	const PORTA_CABRA = 'portas/cabra.png'
	const PORTA_CARRO = 'portas/carro.png'
	

	const ALT_TEXT = {
		[TROCAR_PORTA]: 'Desenho de uma porta verde fechada escrito "ou quer trocar?" em Comic Sans roxa.',
		[MANTER_PORTA]: 'Desenho de uma porta verde fechada escrito "quer manter?" em Comic Sans roxa.',
		[PORTA_CABRA]: 'Desenho do batente verde de uma porta aberta com uma cabra marrom dentro.',
		[PORTA_CARRO]: 'Desenho do batente verde de uma porta aberta com um carro vermelho dentro.',
		[PORTA_FECHADA]: 'Desenho de uma porta verde fechada.'
	}

	portas = document.getElementById('portas')

	function gerar_portas (cabras, carros, abre) {
		portas.abre = abre
		portas.total = cabras + carros 
		portas.cabras = cabras 
		portas.carros = carros 

		portas.selecionada = null
		
		
		for(c = 1; c <= portas.total; c++) {
			const p = document.createElement('img')
			portas.appendChild(p)
			
			p.id = c			
			p.style.width = (100 / (portas.total + 2)) + '%'
			
			
			p.onclick = () => {
				abrir_porta(p)
			}

			p.premiada = false
			p.aberta = false
			
		}

		
		colocar_img()

	}

	function abrir_porta (porta) {
		limpar_func()
		if(portas.selecionada != null) 
			return

		console.log('Você escolheu a porta',porta.id)
		porta.src = MANTER_PORTA
		porta.alt = ALT_TEXT[MANTER_PORTA]
		porta.onclick = manter

		portas.selecionada = porta
		revelar_portas()
	}
	
	function revelar_portas () {
		while(portas.abre > 0) {
			c = Math.floor(portas.childNodes.length * Math.random())
			p = portas.childNodes[c]
			console.log(c,p)

			if(p.id == portas.selecionada.id || p.aberta || p.premiada)
				continue

			mostrar(p)		
			console.log('Há uma cabra na porta',p.id)			
			portas.abre -= 1
		}

		for(c = 0; c < portas.childNodes.length; c++) {
			const p = portas.childNodes[c]
			
			if(p.id == portas.selecionada.id || p.aberta)
				continue

			p.src = TROCAR_PORTA
			p.alt = ALT_TEXT[TROCAR_PORTA]	
			p.onclick = () => {
				trocar_porta(p)
			}
		}
	}

	function limpar_func () {
		for(c = 0; c < portas.childNodes.length; c++)
			portas.childNodes[c].onclick = undefined
	}

	function colocar_img () {
		for(c = 0; c < portas.childNodes.length; c++) {
			p = portas.childNodes[c]
			if(p.aberta)
				continue
			p.src = PORTA_FECHADA
			p.alt = ALT_TEXT[PORTA_FECHADA]
		}
	}

	function mostrar (porta) {
		porta.src = (porta.premiada) ? PORTA_CARRO : PORTA_CABRA
		porta.alt = ALT_TEXT[porta.src]
		porta.aberta = true
	}

	function manter () {
		console.log('Você manteve sua escolha pela porta',portas.selecionada.id)
		limpar_func()

		mostrar(portas.selecionada)		
		colocar_img()
		
			
	}

	function trocar_porta (porta) {
		console.log('Você trocou pela porta',porta.id)
		limpar_func()
		mostrar(porta)

		colocar_img()
	}

	gerar_portas(2,1,1)
</script>

	</body>
</html>